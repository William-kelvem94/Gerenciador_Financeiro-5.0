import{r as a,j as e}from"./index-Bak0-3RP.js";import{u as f}from"./useQuery-NbZskVYw.js";import{u as b,c as n}from"./index-8bq6IgXA.js";import{m as o}from"./proxy-BhDIYVye.js";import{o as y,s as i,g as j,n as N}from"./schemas-Bsxx_dm5.js";const v=y({userId:i().uuid().optional()}),E=a.memo(r=>{const m=a.useMemo(()=>v.parse(r),[r]),[l,c]=a.useState(null),{data:d,isLoading:g,error:s,refetch:u}=f({queryKey:["budgets",m.userId],queryFn:()=>C(m.userId),enabled:!!m.userId,staleTime:300*1e3,retry:2}),{mutate:h,isPending:p}=b({mutationFn:B,onSuccess:()=>{n.success("Orçamento criado com sucesso!"),u()},onError:t=>{n.error(`Erro: ${t.message}`),c(t.message)}}),x=a.useMemo(()=>d?d.map(t=>({...t,formattedAmount:P(t.amount),formattedPeriod:k(t.period)})):[],[d]);return a.useEffect(()=>{s&&(c(s.message),n.error(`Erro ao carregar orçamentos: ${s.message}`))},[s]),g?e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center min-h-screen bg-background-primary",children:e.jsx("div",{className:"animate-pulse text-cyber-primary",children:"Carregando orçamentos..."})}):l?e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"p-6 bg-red-500/10 border border-red-500/20 rounded-lg max-w-md mx-auto mt-16",children:[e.jsx("p",{className:"text-red-400",children:l}),e.jsx("button",{onClick:()=>{c(null),u()},className:"mt-4 btn btn-primary",children:"Tentar Novamente"})]}):e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"container mx-auto py-12 min-h-screen bg-background-primary","data-testid":"budgets-page",children:[e.jsxs("header",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-cyber-primary mb-2 text-glow",children:"Orçamentos"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Controle e análise de orçamentos"})]}),e.jsx("main",{children:x.length>0?e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(t=>e.jsxs(o.li,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:"card glass",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("span",{className:"card-title",children:t.name}),e.jsx("span",{className:"card-description",children:t.description})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"font-mono text-cyber-accent text-lg",children:t.formattedAmount}),e.jsx("span",{className:"text-muted-foreground",children:t.formattedPeriod})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>n("Editar orçamento (em breve)"),children:"Editar"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>n("Excluir orçamento (em breve)"),children:"Excluir"})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Nenhum orçamento cadastrado."}),e.jsx("button",{className:"btn btn-primary",disabled:p,onClick:()=>h({name:"Novo Orçamento",amount:0,period:"monthly"}),children:p?"Criando...":"Criar Orçamento"})]})})]})});E.displayName="BudgetsPage";y({id:i().uuid(),name:i().min(1),description:i().optional(),amount:N().nonnegative(),period:j(["monthly","yearly","weekly"])});async function C(r){return[{id:"1",name:"Orçamento Exemplo",amount:500,period:"monthly",description:"Orçamento de exemplo"}]}async function B(r){return{id:"2",name:r.name??"",amount:r.amount??0,period:r.period??"monthly",description:r.description??""}}function P(r){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r)}function k(r){switch(r){case"monthly":return"Mensal";case"yearly":return"Anual";case"weekly":return"Semanal";default:return""}}export{E as default};
