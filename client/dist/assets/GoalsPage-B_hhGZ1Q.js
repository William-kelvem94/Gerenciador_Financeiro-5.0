import{r as i,j as e}from"./index-Bak0-3RP.js";import{u as f}from"./useQuery-NbZskVYw.js";import{u as j,c}from"./index-8bq6IgXA.js";import{m as n}from"./proxy-BhDIYVye.js";import{o as g,s as a,n as x}from"./schemas-Bsxx_dm5.js";const N=g({userId:a().uuid().optional()});g({id:a(),title:a(),amount:x(),progress:x(),deadline:a().optional(),description:a().optional()});function b(r){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r)}function v(r){return new Date(r).toLocaleDateString("pt-BR",{year:"numeric",month:"short",day:"2-digit"})}async function E(r){return[{id:"1",title:"Meta Exemplo",amount:1e3,progress:50,deadline:new Date().toISOString(),description:"Meta de exemplo"}]}async function w(r){return{id:"2",title:r.title??"",amount:r.amount??0,progress:r.progress??0,deadline:r.deadline??new Date().toISOString(),description:r.description??""}}const S=i.memo(r=>{const d=i.useMemo(()=>N.parse(r),[r]),[l,m]=i.useState(null),{data:o,isLoading:y,error:s,refetch:u}=f({queryKey:["goals",d.userId],queryFn:()=>E(d.userId),enabled:!0,staleTime:300*1e3,retry:2}),{mutate:h,isPending:p}=j({mutationFn:w,onSuccess:()=>{c.success("Meta criada com sucesso!"),u()},onError:t=>{c.error(`Erro: ${t.message}`),m(t.message)}});return i.useEffect(()=>{s&&(m(s.message),c.error(`Erro ao carregar metas: ${s.message}`))},[s]),y?e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-pulse text-cyber-primary",children:"Carregando metas..."})}):l?e.jsxs(n.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg m-8",children:[e.jsx("p",{className:"text-red-400",children:l}),e.jsx("button",{onClick:()=>u(),className:"mt-2 px-4 py-2 bg-red-500 text-white rounded",children:"Tentar Novamente"})]}):e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"container mx-auto py-12","data-testid":"goals-page",children:[e.jsxs("header",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-cyber-primary mb-2",children:"Metas Financeiras"}),e.jsx("p",{className:"text-muted-foreground",children:"Defina e acompanhe suas metas financeiras"})]}),e.jsx("main",{children:o&&o.length>0?e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(t=>e.jsxs(n.li,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:"card shadow-lg",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{className:"card-title text-xl font-semibold text-cyber-primary",children:t.title}),e.jsx("span",{className:"card-description",children:t.description})]}),e.jsxs("div",{className:"card-content flex flex-col gap-2",children:[e.jsxs("span",{className:"text-glow text-lg",children:["Valor: ",b(t.amount)]}),e.jsxs("span",{className:"text-muted-foreground",children:["Prazo: ",t.deadline?v(t.deadline):"Sem prazo"]}),e.jsx("div",{className:"w-full bg-background-tertiary rounded-full h-3 mt-2",children:e.jsx("div",{className:"bg-cyber-accent h-3 rounded-full",style:{width:`${t.progress}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Progresso: ",t.progress,"%"]})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Nenhuma meta cadastrada."}),e.jsx("button",{onClick:()=>h({title:"Nova Meta",amount:1e3,progress:0,description:"Exemplo de meta"}),disabled:p,className:"btn btn-primary",children:p?"Criando...":"Criar Meta Exemplo"})]})})]})});S.displayName="GoalsPage";export{S as default};
