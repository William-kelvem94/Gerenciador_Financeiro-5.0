import{r as c,j as e}from"./index-Bak0-3RP.js";import{u as S,c as x}from"./index-8bq6IgXA.js";import{m as A}from"./proxy-BhDIYVye.js";import{_ as y,a as k,b as C,$ as F,c as N,p as b,d as w,e as g,o as v,s as j}from"./schemas-Bsxx_dm5.js";class P{constructor(t){this._def=t,this.def=t}implement(t){if(typeof t!="function")throw new Error("implement() must be called with a function");const s=(...i)=>{const n=this._def.input?b(this._def.input,i,void 0,{callee:s}):i;if(!Array.isArray(n))throw new Error("Invalid arguments schema: not an array or tuple schema.");const o=t(...n);return this._def.output?b(this._def.output,o,void 0,{callee:s}):o};return s}implementAsync(t){if(typeof t!="function")throw new Error("implement() must be called with a function");const s=async(...i)=>{const n=this._def.input?await w(this._def.input,i,void 0,{callee:s}):i;if(!Array.isArray(n))throw new Error("Invalid arguments schema: not an array or tuple schema.");const o=await t(...n);return this._def.output?w(this._def.output,o,void 0,{callee:s}):o};return s}input(...t){const s=this.constructor;return Array.isArray(t[0])?new s({type:"function",input:new N({type:"tuple",items:t[0],rest:t[1]}),output:this._def.output}):new s({type:"function",input:t[0],output:this._def.output})}output(t){const s=this.constructor;return new s({type:"function",input:this._def.input,output:t})}}function L(l){return new P({type:"function",input:Array.isArray(l?.input)?k(N,l?.input):C(F,y(g)),output:y(g)})}const $=v({onSuccess:L().optional()}),M=v({email:j().email(),password:j().min(6,"Senha mínima de 6 caracteres")}),O=c.memo(l=>{const t=c.useMemo(()=>$.parse(l),[l]),[s,i]=c.useState({email:"",password:""}),[n,o]=c.useState({}),[d,E]=c.useState(!1),{mutate:p,isPending:u}=S({mutationFn:async a=>{const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw new Error("Credenciais inválidas");return r.json()},onSuccess:a=>{x.success("Login realizado!"),t.onSuccess?.(a.token)},onError:a=>{x.error(a.message||"Erro ao logar")}}),h=c.useCallback(a=>{i(r=>({...r,[a.target.name]:a.target.value})),o(r=>({...r,[a.target.name]:""}))},[]),_=c.useCallback(a=>{a.preventDefault(),o({});const r=M.safeParse(s);if(!r.success){const f={};r.error.issues.forEach(m=>{m.path[0]&&(f[String(m.path[0])]=m.message)}),o(f);return}p(r.data)},[s,p]);return e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex flex-col items-center justify-center min-h-screen bg-background-primary","data-testid":"login-page",children:e.jsxs("div",{className:"card w-full max-w-md p-8 shadow-lg glass",children:[e.jsx("h2",{className:"text-2xl font-bold text-cyber-primary mb-4 text-center text-glow",children:"Login"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:_,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-cyber-primary mb-1",children:"E-mail"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",className:"input",value:s.email,onChange:h,disabled:u,"data-testid":"email-input"}),n.email&&e.jsx("span",{className:"text-xs text-cyber-danger",children:n.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-cyber-primary mb-1",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:d?"text":"password",autoComplete:"current-password",className:"input pr-10",value:s.password,onChange:h,disabled:u,"data-testid":"password-input"}),e.jsx("button",{type:"button",className:"absolute right-2 top-2 text-cyber-secondary text-xs btn-ghost",onClick:()=>E(a=>!a),tabIndex:-1,"aria-label":d?"Ocultar senha":"Mostrar senha",children:d?"Ocultar":"Mostrar"})]}),n.password&&e.jsx("span",{className:"text-xs text-cyber-danger",children:n.password})]}),e.jsx("button",{type:"submit",className:"btn btn-primary mt-4",disabled:u,"data-testid":"login-button",children:u?"Entrando...":"Entrar"})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("a",{href:"/register",className:"text-cyber-secondary hover:underline text-sm",children:"Não tem conta? Cadastre-se"}),e.jsx("br",{}),e.jsx("a",{href:"/forgot-password",className:"text-cyber-accent hover:underline text-xs",children:"Esqueceu a senha?"})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2",children:[e.jsx("button",{className:"btn btn-secondary w-full",disabled:!0,children:"Entrar com Google (em breve)"}),e.jsx("button",{className:"btn btn-secondary w-full",disabled:!0,children:"Entrar com Facebook (em breve)"})]}),e.jsx("p",{className:"text-muted-foreground text-xs mt-8 text-center",children:"Tela de login do Will Finance 5.0"})]})})});O.displayName="LoginPage";export{O as LoginPage,O as default};
